/**
 * PeekCarousel - Peek 효과를 가진 캐러셀
 * @version 1.0.0
 * @license MIT
 * @author lledellebell
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).PeekCarousel=e()}(this,function(){"use strict";const t=Object.freeze({STACK:"stack",RADIAL:"radial",CLASSIC:"classic"}),e=Object.freeze({startIndex:1,layoutMode:t.STACK,autoRotate:!1,autoRotateInterval:2500,preloadRange:2,swipeThreshold:50,dragThreshold:80,enableKeyboard:!0,enableWheel:!0,enableTouch:!0,enableMouse:!0,showNavigation:!0,showCounter:!0,showIndicators:!0,showAutoRotateButton:!0});const s=Object.freeze({carousel:"peek-carousel",track:"peek-carousel__track",item:"peek-carousel__item",itemActive:"peek-carousel__item--active",itemPrev:"peek-carousel__item--prev",itemNext:"peek-carousel__item--next",itemCenter:"peek-carousel__item--center",itemHidden:"peek-carousel__item--hidden",itemDraggingLeft:"peek-carousel__item--dragging-left",itemDraggingRight:"peek-carousel__item--dragging-right",figure:"peek-carousel__figure",image:"peek-carousel__image",caption:"peek-carousel__caption",nav:"peek-carousel__nav",navBtn:"nav-btn",btn:"peek-carousel__btn",prevBtn:"prev-btn",nextBtn:"next-btn",autoRotateBtn:"auto-rotate-btn",btnAutoRotate:"peek-carousel__btn--auto-rotate",btnActive:"peek-carousel__btn--active",controls:"peek-carousel__controls",indicators:"peek-carousel__indicators",indicator:"indicator",indicatorPeek:"peek-carousel__indicator",indicatorActive:"peek-carousel__indicator--active",indicatorProgress:"peek-carousel__indicator--progress",indicatorCompleted:"peek-carousel__indicator--completed",counter:"peek-carousel__counter",counterCurrent:"peek-carousel__counter-current",counterSeparator:"peek-carousel__counter-separator",counterTotal:"peek-carousel__counter-total",playIcon:"play-icon",pauseIcon:"pause-icon"}),i=Object.freeze({carousel:".peek-carousel__track",item:".peek-carousel__item",indicator:".indicator",prevBtn:".prev-btn",nextBtn:".next-btn",autoRotateBtn:".auto-rotate-btn",playIcon:".play-icon",pauseIcon:".pause-icon",image:"img"}),a=Object.freeze({current:"aria-current",selected:"aria-selected",pressed:"aria-pressed",label:"aria-label",tabindex:"tabindex"}),o=Object.freeze({mobile:768}),r=Object.freeze({transition:500,progressReset:10}),n=Object.freeze({arrowLeft:"ArrowLeft",arrowRight:"ArrowRight",home:"Home",end:"End",space:" "});function c(t,...e){t instanceof HTMLElement&&e.length>0&&t.classList.add(...e)}function l(t,...e){t instanceof HTMLElement&&e.length>0&&t.classList.remove(...e)}function u(t,e,s){t instanceof HTMLElement&&e&&t.setAttribute(e,s)}const h=new Map;function d(t){if(!t||0===t.length)return Promise.resolve([]);const e=[...new Set(t)];return Promise.all(e.map(t=>function(t){return new Promise((e,s)=>{if(!t)return void s(new Error("이미지 소스가 제공되지 않았습니다"));if(h.has(t))return h.get(t);const i=new Image,a=new Promise((e,s)=>{i.onload=()=>{h.delete(t),e(i)},i.onerror=()=>{h.delete(t),s(new Error(`이미지 로드 실패: ${t}`))},i.src=t});h.set(t,a),a.then(e,s)})}(t)))}const m=new Map;const p={prev:{path:"M15 18L9 12L15 6",options:{}},next:{path:"M9 18L15 12L9 6",options:{}},play:{path:"M8 6.5v11l9-5.5z",options:{fill:"currentColor",stroke:"currentColor",strokeWidth:0,strokeLinecap:"round",strokeLinejoin:"round"}},pause:{path:"M7 5.5C7 5.22386 7.22386 5 7.5 5H9.5C9.77614 5 10 5.22386 10 5.5V18.5C10 18.7761 9.77614 19 9.5 19H7.5C7.22386 19 7 18.7761 7 18.5V5.5ZM14 5.5C14 5.22386 14.2239 5 14.5 5H16.5C16.7761 5 17 5.22386 17 5.5V18.5C17 18.7761 16.7761 19 16.5 19H14.5C14.2239 19 14 18.7761 14 18.5V5.5Z",options:{fill:"currentColor",stroke:"none"}}};function g(t,e={}){const s=p[t];if(!s)return console.warn(`PeekCarousel: 아이콘 "${t}"을 찾을 수 없습니다`),"";const i={...s.options,...e};return function(t,e={}){const{width:s=24,height:i=24,viewBox:a="0 0 24 24",fill:o="none",stroke:r="currentColor",strokeWidth:n=2,strokeLinecap:c="round",strokeLinejoin:l="round",className:u=""}=e,h=`${t}-${JSON.stringify(e)}`;if(m.has(h))return m.get(h);const d=`<svg width="${s}" height="${i}" viewBox="${a}" fill="${o}" xmlns="http://www.w3.org/2000/svg" class="${u}"><path d="${t}" stroke="${r}" stroke-width="${n}" stroke-linecap="${c}" stroke-linejoin="${l}"/></svg>`;return m.set(h,d),d}(s.path,i)}function v(t,e,s={}){if(!(t&&t instanceof HTMLElement))return;if(t.querySelector("svg"))return;const i=g(e,s);i&&(t.innerHTML=i)}function f(t,e){return e<=0?0:(t%e+e)%e}class b{constructor(t){this.carousel=t}get currentIndex(){return this.carousel.state.currentIndex}set currentIndex(t){this.carousel.state.currentIndex=f(t,this.carousel.totalItems)}getShortestDistance(t,e){const s=this.carousel.totalItems,i=f(e,s),a=f(t,s),o=(i-a+s)%s,r=(a-i+s)%s;return o<=r?o:-r}isNearby(t,e){return Math.abs(this.getShortestDistance(t,e))<=2}updateAfterNavigation(){this.carousel.animator.updateCarousel(),this.carousel.updateCounter(),this.carousel.options.preloadRange>0&&this.carousel.preloadImages()}rotate(t){this.currentIndex=this.currentIndex+t,this.updateAfterNavigation()}next(){this.rotate(1)}prev(){this.rotate(-1)}goTo(t){const e=f(t,this.carousel.totalItems);e!==this.currentIndex&&(this.currentIndex=e,this.updateAfterNavigation())}navigateIfDifferent(t,e){const s=f(t,this.carousel.totalItems);return s!==this.currentIndex&&(e(s),!0)}handleItemClick(t){this.navigateIfDifferent(t,t=>{const{layoutMode:e}=this.carousel.options;"radial"===e?this.handleRadialItemClick(t):this.handleStackItemClick(t)})}handleRadialItemClick(t){const e=this.getShortestDistance(this.currentIndex,t);if(Math.abs(e)>1){const t=e>0?1:-1;this.rotate(t)}else this.rotate(e)}handleStackItemClick(t){if(this.isNearby(this.currentIndex,t)){const e=this.getShortestDistance(this.currentIndex,t);this.rotate(e)}else this.goTo(t)}handleIndicatorClick(t){this.navigateIfDifferent(t,t=>{const{layoutMode:e}=this.carousel.options;if("radial"===e){const e=this.getShortestDistance(this.currentIndex,t);this.rotate(e)}else this.goTo(t)})}}const y=Object.freeze({center:{x:50,scale:1},peek:{scale:1},hidden:{scale:.85}}),I=Object.freeze({gapPercent:5,additionalMobile:40,additionalDesktop:15,mobileBreakpoint:768}),k=Object.freeze({friction:.92,minVelocity:.05,navigationThreshold:1.5,dampingFactor:.6}),x=[s.itemCenter,s.itemPrev,s.itemNext,s.itemHidden];class C{constructor(t){this.carousel=t,this.momentumAnimation=null,this.isAnimating=!1}normalizeAngleDiff(t){return(t+180)%360-180}round(t,e=2){return Math.round(t*10**e)/10**e}getAdjacentIndices(t){return{prev:f(t-1,this.carousel.totalItems),next:f(t+1,this.carousel.totalItems)}}setCarouselRotation(t){const e=this.round(t,2);this.carousel.container.style.setProperty("--carousel-rotation",`${e}deg`)}setCSSVariables(t,e){for(const[s,i]of Object.entries(e))t.style.setProperty(s,i)}updateRadialRotation(t){const e=-this.carousel.state.angleUnit*t,s=this.carousel.container.style.getPropertyValue("--carousel-rotation");if(!s||"0deg"===s)return void this.setCarouselRotation(e);const i=parseFloat(s),a=i+this.normalizeAngleDiff(e-i);this.setCarouselRotation(a)}updateCarousel(){const{currentIndex:t}=this.carousel.state,{layoutMode:e}=this.carousel.options;"stack"===e||"classic"===e?this.setCarouselRotation(0):"radial"===e&&this.updateRadialRotation(t),this.updateActiveItem()}updateActiveItem(){const{currentIndex:t}=this.carousel.state,{layoutMode:e}=this.carousel.options;this.carousel.ui.updateActiveStates(t),"radial"===e?this.updateRadialPositions(t):"classic"===e?this.updateClassicPositions(t):this.updateStackPositions(t)}updateRadialPositions(t){const{angleUnit:e}=this.carousel.state;for(let t=0;t<this.carousel.items.length;t++){const s=this.carousel.items[t],i=e*t;this.setCSSVariables(s,{"--item-angle":`${this.round(i,2)}deg`,"--item-radius":"400px"})}const{prev:s,next:i}=this.getAdjacentIndices(t);this.carousel.ui.setPeekItems(s,i)}updateStackPositions(t){const{prev:e,next:i}=this.getAdjacentIndices(t);for(let a=0;a<this.carousel.items.length;a++){const o=this.carousel.items[a];o.classList.remove(...x),a===t?o.classList.add(s.itemCenter):a===e?o.classList.add(s.itemPrev):a===i?o.classList.add(s.itemNext):o.classList.add(s.itemHidden)}}calculateClassicSpacing(t){const e=Math.max(300,Math.min(.35*t,500)),s=t<=I.mobileBreakpoint;return e/t*50+I.gapPercent+(s?I.additionalMobile:I.additionalDesktop)}getClassicItemPosition(t,e,s){const{prev:i,next:a}=this.getAdjacentIndices(e);if(t===e)return{x:y.center.x,scale:y.center.scale};if(t===i)return{x:y.center.x-s,scale:y.peek.scale};if(t===a)return{x:y.center.x+s,scale:y.peek.scale};return{x:t-e<0?y.center.x-2*s:y.center.x+2*s,scale:y.hidden.scale}}updateClassicPositions(t){const{prev:e,next:s}=this.getAdjacentIndices(t),i=this.carousel.container.offsetWidth,a=this.calculateClassicSpacing(i);for(let e=0;e<this.carousel.items.length;e++){const s=this.carousel.items[e],{x:i,scale:o}=this.getClassicItemPosition(e,t,a);this.setCSSVariables(s,{"--item-x":`${this.round(i,2)}%`,"--item-scale":String(o)})}this.carousel.ui.setPeekItems(e,s)}startMomentum(t){this.stopMomentum();let e=t;const s=()=>{if(e*=k.friction,Math.abs(e)<k.minVelocity)this.stopMomentum();else{if(Math.abs(e)>k.navigationThreshold){const t=e>0?-1:1;this.carousel.navigator.rotate(t),e*=k.dampingFactor}this.momentumAnimation=requestAnimationFrame(s)}};this.isAnimating=!0,this.momentumAnimation=requestAnimationFrame(s)}stopMomentum(){this.momentumAnimation&&(cancelAnimationFrame(this.momentumAnimation),this.momentumAnimation=null),this.isAnimating=!1}}class A{constructor(t){this.carousel=t,this.interval=null,this.isActive=!1}setActiveState(t){this.isActive=t,this.carousel.ui.updateAutoRotateButton(t)}toggle(){this.isActive?this.stop():this.start()}start(){if(this.isActive)return;this.setActiveState(!0);const t=this.carousel.options.autoRotateInterval;this.interval=setInterval(()=>{this.carousel.navigator.next()},t)}stop(){this.isActive&&(this.setActiveState(!1),this.interval&&(clearInterval(this.interval),this.interval=null))}destroy(){this.stop(),this.carousel=null}}const w=Object.freeze({threshold:50,timeout:150,cooldown:100}),R=Object.freeze({touchThreshold:15,mouseThreshold:10,velocityThreshold:.5});let T=0;class M{constructor(t){this.carousel=t,this.boundHandlers=new Map,this.resizeTimer=null,this.touch={startX:0,endX:0},this.drag={active:!1,startX:0,currentX:0,lastX:0,lastTime:0,velocity:0},this.wheel={isScrolling:!1,scrollTimeout:null,lastWheelTime:0,accumulatedDelta:0}}init(){this.initNavigationButtons(),this.initKeyboard(),this.initWheel(),this.initItemClick(),this.initIndicatorClick(),this.initTouch(),this.initMouse(),this.initResize()}stopAutoRotateAndNavigate(t){this.completeCurrentIndicator(),this.carousel.autoRotate.stop(),t()}completeCurrentIndicator(){const t=this.carousel.indicators[this.carousel.state.currentIndex];t&&t.classList.contains("peek-carousel__indicator--active")&&t.classList.add("peek-carousel__indicator--completed")}resetDragState(t){this.carousel.ui.removeDraggingClass(t),this.carousel.ui.clearDragTransform()}updateDraggingClass(t,e,s){t>s?this.carousel.ui.addDraggingClass(e,"right"):t<-s&&this.carousel.ui.addDraggingClass(e,"left")}initDragState(t){this.drag.active=!0,this.drag.startX=t,this.drag.currentX=t,this.drag.lastX=t,this.drag.lastTime=Date.now(),this.drag.velocity=0}resetMouseCursor(){this.carousel.elements.carousel.style.cursor="grab"}calculateWheelDelta(t){return Math.abs(t.deltaX)>Math.abs(t.deltaY)?-t.deltaX:t.deltaY}resetWheelState(){this.wheel.isScrolling=!1,this.wheel.accumulatedDelta=0}initNavigationButtons(){const{prevBtn:t,nextBtn:e,autoRotateBtn:s}=this.carousel.elements;t&&this.addHandler(t,"click",()=>{this.stopAutoRotateAndNavigate(()=>this.carousel.navigator.prev())}),e&&this.addHandler(e,"click",()=>{this.stopAutoRotateAndNavigate(()=>this.carousel.navigator.next())}),s&&this.addHandler(s,"click",()=>{this.carousel.autoRotate.toggle()})}initKeyboard(){if(!this.carousel.options.enableKeyboard)return;this.addHandler(document,"keydown",t=>{const{navigator:e,autoRotate:s,totalItems:i}=this.carousel;switch(t.key){case n.arrowLeft:s.stop(),e.prev();break;case n.arrowRight:s.stop(),e.next();break;case n.home:t.preventDefault(),s.stop(),e.goTo(0);break;case n.end:t.preventDefault(),s.stop(),e.goTo(i-1);break;case n.space:t.preventDefault(),s.toggle();break;default:const a=parseInt(t.key);a>=1&&a<=i&&(t.preventDefault(),s.stop(),e.goTo(a-1))}})}initWheel(){if(!this.carousel.options.enableWheel)return;this.addHandler(this.carousel.elements.carousel,"wheel",t=>{const e=Math.abs(t.deltaX),s=Math.abs(t.deltaY);if(e<1&&s<1)return;if(e===s)return;t.preventDefault();const i=Date.now();if(!(i-this.wheel.lastWheelTime<w.cooldown)){if(this.wheel.isScrolling||(this.wheel.isScrolling=!0,this.wheel.accumulatedDelta=0,this.carousel.autoRotate.stop(),this.carousel.animator.stopMomentum()),this.wheel.accumulatedDelta+=this.calculateWheelDelta(t),Math.abs(this.wheel.accumulatedDelta)>=w.threshold){const t=this.wheel.accumulatedDelta>0?1:-1;this.carousel.navigator.rotate(t),this.wheel.accumulatedDelta=0,this.wheel.lastWheelTime=i}clearTimeout(this.wheel.scrollTimeout),this.wheel.scrollTimeout=setTimeout(()=>{this.resetWheelState()},w.timeout)}},{passive:!1})}initItemClick(){const{items:t}=this.carousel;for(let e=0;e<t.length;e++)this.addHandler(t[e],"click",()=>{this.carousel.autoRotate.stop(),this.carousel.navigator.handleItemClick(e)})}initIndicatorClick(){const{indicators:t}=this.carousel;for(let e=0;e<t.length;e++)this.addHandler(t[e],"click",()=>{this.carousel.autoRotate.stop(),this.carousel.navigator.handleIndicatorClick(e)})}initTouch(){this.carousel.options.enableTouch&&(this.addHandler(this.carousel.elements.carousel,"touchstart",t=>{this.touch.startX=t.changedTouches[0].screenX}),this.addHandler(this.carousel.elements.carousel,"touchmove",t=>{const e=t.changedTouches[0].screenX-this.touch.startX,{currentIndex:s}=this.carousel.state;this.carousel.ui.updateDragTransform(e),this.updateDraggingClass(e,s,R.touchThreshold)}),this.addHandler(this.carousel.elements.carousel,"touchend",t=>{this.touch.endX=t.changedTouches[0].screenX;const e=this.touch.endX-this.touch.startX,{swipeThreshold:s}=this.carousel.options,{currentIndex:i}=this.carousel.state;this.resetDragState(i),e<-s?(this.carousel.autoRotate.stop(),this.carousel.navigator.next()):e>s&&(this.carousel.autoRotate.stop(),this.carousel.navigator.prev())}))}initMouse(){this.carousel.options.enableMouse&&(this.addHandler(this.carousel.elements.carousel,"mousedown",t=>{window.innerWidth<=768||(this.initDragState(t.clientX),this.carousel.autoRotate.stop(),this.carousel.animator.stopMomentum(),this.carousel.elements.carousel.style.cursor="grabbing",t.preventDefault())}),this.addHandler(document,"mousemove",t=>{if(!this.drag.active)return;const e=Date.now(),s=e-this.drag.lastTime,i=t.clientX-this.drag.lastX;s>0&&(this.drag.velocity=i/s),this.drag.currentX=t.clientX,this.drag.lastX=t.clientX,this.drag.lastTime=e;const a=this.drag.currentX-this.drag.startX,{currentIndex:o}=this.carousel.state;if(this.carousel.ui.updateDragTransform(a),this.updateDraggingClass(a,o,R.mouseThreshold),Math.abs(a)>this.carousel.options.dragThreshold){const t=a>0?-1:1;this.carousel.navigator.rotate(t),this.drag.startX=this.drag.currentX,this.resetDragState(o)}}),this.addHandler(document,"mouseup",()=>{if(!this.drag.active)return;this.drag.active=!1,this.resetMouseCursor();const{currentIndex:t}=this.carousel.state;this.resetDragState(t),Math.abs(this.drag.velocity)>R.velocityThreshold&&this.carousel.animator.startMomentum(this.drag.velocity)}),this.addHandler(this.carousel.elements.carousel,"mouseleave",()=>{if(this.drag.active){this.drag.active=!1,this.resetMouseCursor();const{currentIndex:t}=this.carousel.state;this.resetDragState(t)}}),window.innerWidth>o.mobile&&this.resetMouseCursor())}initResize(){this.addHandler(window,"resize",()=>{clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(()=>{this.carousel&&this.carousel.animator.updateCarousel()},100)})}addHandler(t,e,s,i){t.addEventListener(e,s,i);const a=`${e}-${++T}`;this.boundHandlers.set(a,{element:t,event:e,handler:s,options:i})}destroy(){this.wheel.scrollTimeout&&(clearTimeout(this.wheel.scrollTimeout),this.wheel.scrollTimeout=null),this.resizeTimer&&(clearTimeout(this.resizeTimer),this.resizeTimer=null);for(const{element:t,event:e,handler:s,options:i}of this.boundHandlers.values())t.removeEventListener(e,s,i);this.boundHandlers.clear(),this.drag.active=!1,this.drag.velocity=0,this.wheel.isScrolling=!1,this.wheel.accumulatedDelta=0,this.carousel=null}}const S=Object.freeze({stack:{maxDrag:200,offsetMultiplier:100,rotationMultiplier:3},radial:{rotationSensitivity:.2},classic:{dragSensitivity:.5}});class D{constructor(t){this.carousel=t}updateActiveStates(t){for(let t=0;t<this.carousel.items.length;t++){const e=this.carousel.items[t];l(e,s.itemActive,s.itemPrev,s.itemNext),e.removeAttribute(a.current)}for(let t=0;t<this.carousel.indicators.length;t++){const e=this.carousel.indicators[t];l(e,s.indicatorActive,s.indicatorProgress),u(e,a.selected,"false"),u(e,a.tabindex,"-1")}const e=this.carousel.items[t],i=this.carousel.indicators[t];e&&(c(e,s.itemActive),u(e,a.current,"true")),i&&(l(i,s.indicatorCompleted),c(i,s.indicatorActive),u(i,a.selected,"true"),u(i,a.tabindex,"0"),this.carousel.autoRotate.isActive&&this.updateIndicatorProgress(i))}updateIndicatorProgress(t){var e,i,a;e=t,i="--progress-duration",a=`${this.carousel.options.autoRotateInterval}ms`,e instanceof HTMLElement&&i&&e.style.setProperty(i,a),setTimeout(()=>{t&&c(t,s.indicatorProgress)},r.progressReset)}clearPeekItems(){for(let t=0;t<this.carousel.items.length;t++){l(this.carousel.items[t],s.itemPrev,s.itemNext)}}setPeekItems(t,e){const i=this.carousel.items[t],a=this.carousel.items[e];i&&c(i,s.itemPrev),a&&c(a,s.itemNext)}updateAutoRotateButton(t){const{autoRotateBtn:e}=this.carousel.elements;e&&(t?(c(e,s.btnActive),u(e,a.pressed,"true")):(l(e,s.btnActive),u(e,a.pressed,"false")))}addDraggingClass(t,e){const i=this.carousel.items[t];if(!i)return;const a=s.itemDraggingLeft,o=s.itemDraggingRight;l(i,a,o),"left"===e?c(i,a):"right"===e&&c(i,o)}removeDraggingClass(t){const e=this.carousel.items[t];e&&l(e,s.itemDraggingLeft,s.itemDraggingRight)}round(t,e=2){return Math.round(t*10**e)/10**e}applyEasing(t){return t*(2-Math.abs(t))}updateDragTransform(t){const{layoutMode:e}=this.carousel.options;if("stack"===e){const e=S.stack,s=Math.max(-e.maxDrag,Math.min(e.maxDrag,t))/e.maxDrag,i=this.applyEasing(s),a=this.round(i*e.offsetMultiplier),o=this.round(i*e.rotationMultiplier);this.carousel.container.style.setProperty("--drag-offset",`${a}px`),this.carousel.container.style.setProperty("--drag-rotation",`${o}deg`)}else if("radial"===e){const e=S.radial,s=this.round(t*e.rotationSensitivity);this.carousel.container.style.setProperty("--drag-rotation-y",`${s}deg`)}else if("classic"===e){const e=S.classic,s=this.round(t*e.dragSensitivity);this.carousel.container.style.setProperty("--drag-offset",`${s}px`)}}clearDragTransform(){this.carousel.container.style.setProperty("--drag-offset","0px"),this.carousel.container.style.setProperty("--drag-rotation","0deg"),this.carousel.container.style.setProperty("--drag-rotation-y","0deg")}destroy(){}}return class{constructor(s,i={}){if(this.container=function(t){return"string"==typeof t?document.querySelector(t):t instanceof HTMLElement?t:null}(s),!this.container)throw new Error(`PeekCarousel: 셀렉터 "${s}"에 해당하는 컨테이너를 찾을 수 없습니다`);if(this.options=function(s){const i={...e,...s};return i.startIndex<0&&(console.warn("PeekCarousel: startIndex는 0 이상이어야 합니다. 기본값 1 사용"),i.startIndex=1),Object.values(t).includes(i.layoutMode)||(console.warn(`PeekCarousel: 유효하지 않은 layoutMode "${i.layoutMode}". 기본값 "stack" 사용`),i.layoutMode=t.STACK),i.autoRotateInterval<100&&(console.warn("PeekCarousel: autoRotateInterval은 100ms 이상이어야 합니다. 기본값 2500 사용"),i.autoRotateInterval=2500),i.preloadRange<0&&(console.warn("PeekCarousel: preloadRange는 0 이상이어야 합니다. 기본값 2 사용"),i.preloadRange=2),i}(i),this.initElements(),0===this.items.length)throw new Error("PeekCarousel: 캐러셀 아이템을 찾을 수 없습니다");this.state={currentIndex:this.options.startIndex,angleUnit:360/this.totalItems},this.initModules(),this.init()}initElements(){this.elements={carousel:this.container.querySelector(i.carousel),prevBtn:null,nextBtn:null,autoRotateBtn:null,controls:null,nav:null},this.items=function(t,e=document){return"string"!=typeof t?[]:Array.from(e.querySelectorAll(t))}(i.item,this.container),this.totalItems=this.items.length,this.indicators=[]}initModules(){this.navigator=new b(this),this.animator=new C(this),this.autoRotate=new A(this),this.eventHandler=new M(this),this.ui=new D(this)}init(){this.updateLayoutClass(),this.createNavigation(),this.createControls(),this.injectIcons(),this.createCounter(),this.setImageLoadingAttributes(),this.initCSSVariables(),this.eventHandler.init(),this.animator.updateCarousel(),this.options.autoRotate&&this.autoRotate.start(),this.options.preloadRange>0&&this.preloadImages()}initCSSVariables(){this.container.style.setProperty("--carousel-rotation","0deg"),this.container.style.setProperty("--drag-offset","0px"),this.container.style.setProperty("--drag-rotation","0deg"),this.container.style.setProperty("--drag-rotation-y","0deg")}createNavigation(){if(!this.options.showNavigation)return;const t=this.container.querySelector(`.${s.nav}`);if(t)return this.elements.nav=t,this.elements.prevBtn=t.querySelector(i.prevBtn),void(this.elements.nextBtn=t.querySelector(i.nextBtn));const e=document.createElement("div");e.className=s.nav;const a=document.createElement("button");a.className=`${s.navBtn} ${s.btn} ${s.prevBtn}`,a.setAttribute("aria-label","Previous");const o=document.createElement("button");o.className=`${s.navBtn} ${s.btn} ${s.nextBtn}`,o.setAttribute("aria-label","Next"),e.appendChild(a),e.appendChild(o),this.container.appendChild(e),this.elements.nav=e,this.elements.prevBtn=a,this.elements.nextBtn=o}createControls(){if(!this.options.showIndicators&&!this.options.showAutoRotateButton)return;const t=this.container.querySelector(`.${s.controls}`);if(t){this.elements.controls=t;const e=t.querySelector(`.${s.indicators}`);return e&&this.options.showIndicators&&(e.innerHTML="",this.createIndicators(e)),void(this.elements.autoRotateBtn=t.querySelector(i.autoRotateBtn))}const e=document.createElement("div");if(e.className=s.controls,this.options.showIndicators){const t=document.createElement("div");t.className=s.indicators,this.createIndicators(t),e.appendChild(t)}if(this.options.showAutoRotateButton){const t=document.createElement("button");t.className=`${s.autoRotateBtn} ${s.btn} ${s.btnAutoRotate}`,t.setAttribute("aria-label","Toggle auto-rotate"),t.setAttribute("aria-pressed","false"),e.appendChild(t),this.elements.autoRotateBtn=t}this.container.appendChild(e),this.elements.controls=e}createIndicators(t){this.indicators=[];for(let e=0;e<this.totalItems;e++){const i=document.createElement("button"),a=e===this.state.currentIndex;i.className=s.indicator,i.classList.add(s.indicatorPeek),i.setAttribute("role","tab"),i.setAttribute("aria-label",`Image ${e+1}`),i.setAttribute("aria-selected",a?"true":"false"),i.setAttribute("tabindex",a?"0":"-1"),a&&i.classList.add(s.indicatorActive),t.appendChild(i),this.indicators.push(i)}}injectIcons(){const{prevBtn:t,nextBtn:e,autoRotateBtn:s}=this.elements;t&&v(t,"prev"),e&&v(e,"next"),s&&function(t){if(!(t&&t instanceof HTMLElement))return;if(t.querySelector("svg"))return;const e=g("play",{className:"play-icon"}),s=g("pause",{className:"pause-icon"});e&&s&&(t.innerHTML=e+s)}(s)}createCounter(){if(!this.options.showCounter)return;const t=this.container.querySelector(`.${s.counter}`);if(t)return this.counterElement=t,void this.updateCounter();const e=document.createElement("div");e.className=s.counter,e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),e.innerHTML=`\n      <span class="${s.counterCurrent}">${this.state.currentIndex+1}</span>\n      <span class="${s.counterSeparator}">/</span>\n      <span class="${s.counterTotal}">${this.totalItems}</span>\n    `,this.container.appendChild(e),this.counterElement=e}updateCounter(){if(!this.counterElement)return;const t=this.counterElement.querySelector(`.${s.counterCurrent}`);t&&(t.textContent=this.state.currentIndex+1)}setImageLoadingAttributes(){const{startIndex:t}=this.options,e=this.options.preloadRange||1;for(let i=0;i<this.items.length;i++){const a=this.items[i].querySelector(`.${s.image}`);if(!a||a.hasAttribute("loading"))continue;const o=Math.abs(i-t)<=e;a.setAttribute("loading",o?"eager":"lazy")}}updateLayoutClass(){const t=this.currentLayoutMode,e=this.options.layoutMode;t&&t!==e&&this.container.classList.remove(`peek-carousel--${t}`),this.container.classList.add(`peek-carousel--${e}`),this.currentLayoutMode=e}preloadImages(){!function(t,e,s){if(!t||0===t.length||s<0)return;const i=t.length,a=new Set;for(let o=1;o<=s;o++){const s=(e-o+i)%i,r=(e+o)%i,n=t[s]?.querySelector("img"),c=t[r]?.querySelector("img");n&&n.src&&!n.complete&&a.add(n.src),c&&c.src&&!c.complete&&a.add(c.src)}a.size>0&&d([...a]).catch(t=>{console.warn("일부 이미지 프리로드 실패:",t)})}(this.items,this.state.currentIndex,this.options.preloadRange)}next(){this.navigator.next()}prev(){this.navigator.prev()}goTo(t){this.navigator.goTo(t)}startAutoRotate(){this.autoRotate.start()}stopAutoRotate(){this.autoRotate.stop()}toggleAutoRotate(){this.autoRotate.toggle()}destroy(){this.autoRotate.destroy(),this.animator.stopMomentum(),this.eventHandler.destroy(),this.ui.destroy()}get currentIndex(){return this.state.currentIndex}get isAutoRotating(){return this.autoRotate.isActive}}});
//# sourceMappingURL=peek-carousel.min.js.map
