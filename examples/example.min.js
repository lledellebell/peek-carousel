const DEFAULT_LAYOUT_MODE="stack",DEFAULT_OPTIONS={startIndex:0,layoutMode:"stack",autoRotate:!1,autoRotateInterval:3e3,swipeThreshold:50,dragThreshold:80,preloadRange:2,enableKeyboard:!0,enableWheel:!0,enableTouch:!0,enableMouse:!0},SELECTORS={carousel:"#myCarousel",nav:".peek-carousel__nav",controls:".peek-carousel__controls",counter:".peek-carousel__counter",prevBtn:".prev-btn",layoutButton:".button__group-item",layoutButtonActive:".button__group-item--active[data-layout]",layoutModeGroup:'[aria-label="Layout mode selection"]',controlsToggle:".controls__toggle",controlsClose:".controls__close",controlsPanel:".controls__panel",keyboardToggle:".keyboard__toggle",keyboardPanel:".keyboard__panel",mouseToggle:".mouse__toggle",mousePanel:".mouse__panel"},AUTO_GENERATED_SELECTORS=[SELECTORS.nav,SELECTORS.controls,SELECTORS.counter],TOGGLEABLE_UI_IDS=["showNavigation","showCounter","showIndicators","showAutoRotateButton"],PANELS=[{name:"controls",panelClass:"controls__panel",toggleClass:"controls__toggle"},{name:"keyboard",panelClass:"keyboard__panel",toggleClass:"keyboard__toggle"},{name:"mouse",panelClass:"mouse__panel",toggleClass:"mouse__toggle"},{name:"share",panelClass:"share__panel",toggleClass:"share__toggle"}];let elements={},panelElements={},carousel=null;const buildCarouselOptions=(e=DEFAULT_OPTIONS.startIndex)=>{const t=document.querySelector(SELECTORS.layoutButtonActive)?.dataset.layout||"stack";return{...DEFAULT_OPTIONS,startIndex:e,layoutMode:t,showNavigation:elements.showNavigation?.checked??!0,showCounter:elements.showCounter?.checked??!0,showIndicators:elements.showIndicators?.checked??!0,showAutoRotateButton:elements.showAutoRotateButton?.checked??!0}},removeAutoGeneratedElements=e=>{for(const t of AUTO_GENERATED_SELECTORS){const o=e.querySelector(t);o&&o.remove()}},reinitializeCarousel=()=>{const e=carousel.state.currentIndex;carousel.destroy(),removeAutoGeneratedElements(carousel.container),carousel=new PeekCarousel(SELECTORS.carousel,buildCarouselOptions(e)),moveCounterToNavigation()},closeAllPanels=(e=null)=>{for(const t in panelElements){if(t===e)continue;const{panel:o,toggle:a,activeClass:l}=panelElements[t];o?.classList.remove(l),a?.setAttribute("aria-expanded","false")}},createTogglePanel=e=>()=>{const t=panelElements[e];if(!t)return;const{panel:o,toggle:a,activeClass:l}=t,n=o.classList.toggle(l);a?.setAttribute("aria-expanded",n),n&&closeAllPanels(e)},toggleControlsPanel=createTogglePanel("controls"),toggleKeyboardPanel=createTogglePanel("keyboard"),toggleMousePanel=createTogglePanel("mouse"),toggleSharePanel=createTogglePanel("share"),handleLayoutModeChange=(e,t)=>{const o=e.querySelectorAll(SELECTORS.layoutButton);for(const e of o)e.classList.remove("button__group-item--active"),e.setAttribute("aria-pressed","false");t.classList.add("button__group-item--active"),t.setAttribute("aria-pressed","true");const a=t.dataset.layout;carousel.options.layoutMode=a,carousel.updateLayoutClass(),"stack"===a&&(carousel.elements.carousel.style.transform="none"),carousel.animator.updateCarousel()},attachEventListeners=()=>{const e=document.querySelector(SELECTORS.controlsToggle),t=document.querySelector(SELECTORS.keyboardToggle),o=document.querySelector(SELECTORS.mouseToggle),a=document.querySelector(".share__toggle"),l=document.querySelector(SELECTORS.controlsClose),n=document.querySelector(SELECTORS.layoutModeGroup);e?.addEventListener("click",toggleControlsPanel),t?.addEventListener("click",toggleKeyboardPanel),o?.addEventListener("click",toggleMousePanel),a?.addEventListener("click",toggleSharePanel),l?.addEventListener("click",toggleControlsPanel),n?.addEventListener("click",e=>{const t=e.target.closest(SELECTORS.layoutButton);t&&handleLayoutModeChange(n,t)});for(const e of TOGGLEABLE_UI_IDS)elements[e]?.addEventListener("change",reinitializeCarousel)},cacheElements=()=>{elements=TOGGLEABLE_UI_IDS.reduce((e,t)=>(e[t]=document.getElementById(t),e),{}),panelElements=PANELS.reduce((e,t)=>(e[t.name]={panel:document.querySelector(`.${t.panelClass}`),toggle:document.querySelector(`.${t.toggleClass}`),activeClass:`${t.panelClass}--active`},e),{})},moveCounterToNavigation=()=>{const e=carousel.container.querySelector(SELECTORS.nav);if(!e)return;const t=carousel.container.querySelector(SELECTORS.counter);if(!t)return;const o=e.querySelector(SELECTORS.prevBtn);o&&e.insertBefore(t,o.nextSibling)},init=()=>{cacheElements(),carousel=new PeekCarousel(SELECTORS.carousel,buildCarouselOptions()),moveCounterToNavigation(),attachEventListeners()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",init):init();